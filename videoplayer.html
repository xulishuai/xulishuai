<!DOCTYPE html>
<html>
    <head>
        <title>云播</title>
        <!-- 导入的videojs是7.0版本以上的，集成VHS协议库，可播放HLS流媒体视频 -->
        <link href="videolib/css/video-js.min.css" rel="stylesheet" type="text/css">
        <script src="videolib/js/video.min.js"></script>
        <!-- 引入的videojs-flash.js插件主要是为播放rtmp视频流-->
        <script src="videolib/videojs-flash.min.js"></script>
		
		    <style>

						.urlInput {
							display: block;
							width: 100%;
							margin-left: auto;
							margin-right: auto;
							margin-top: 8px;
							margin-bottom: 8px;
						}
				
						.controls {
							display: block;
							width: 100%;
							text-align: left;
							margin-left: auto;
							margin-right: auto;
						}
			</style>
		
    </head>
    <body>
	
	     <input name="urlinput" class="urlInput" type="text" placeholder="url" value=""/>
        <video id='myvideo' width=960 height=540 class="video-js vjs-default-skin" controls>
            <!-- RTMP直播源地址-->
            <source src="">    
        </video>
		
		<div class="controls">
			<button Onclick="av_start()">Start</button>
			<button Onclick="av_pause()">Pause</button>
			<button Onclick="av_destroy()">Destroy</button>
			<input style="width:100px" type="text" name="seekpoint"/>
			<button Onclick="av_seekto()">SeekTo(s)</button>
		</div>
			
        <script> 
				// console.log(url); 
				var player = document.getElementById("myvideo"); 
				var  source = document.getElementById("myvideo").src
				var flag = false; 
			
				function av_start() {
						if (player.paused == true &&  flag ==true ) {
							//console.log('continue ')
							player.play()
						}
						else{
							//console.log('start play ')
							url = document.getElementsByName('urlinput')[0].value;
							if (url == ''){
								console.log('dedfault play uer ')
								source ="http://flv3.bn.netease.com/tvmrepo/2018/6/H/9/EDJTRBEH9/SD/EDJTRBEH9-mobile.mp4";
							}
							else
								source = url;
								
							//console.log(source);
							document.getElementById("myvideo").src = source 
							player.play()
							flag = true
						}					
				}
		 
				function av_pause() {
						//console.log('av_pause')
						player.pause();
				}
		 
				function av_destroy() {
						//console.log('av_destroy')
						player = null;
						window.location.reload();
				}
		 
				function av_seekto() {
						//console.log('av_seekto')
						var input = document.getElementsByName('seekpoint')[0];
						player.currentTime = parseFloat(input.value);
				}
				
				player.addEventListener("error",function(){
						 var error = player.error;
						 switch(error.code) {
							 case 1:
								console.log("视频的下载过程被中止");
								break;
					 
							 case 2:
								console.log("网络发生故障，视频的下载过程被中止");
								break;
					 
							 case 3:
								console.log("解码失败");
								break;
					 
							 case 4:
								console.log("媒体资源不可用或媒体格式不被支持");
								av_destroy() ;
								break; 
					 
						 }
				},false);
			
        </script>
    </body>
</html>